

{% load static %}
<link rel="stylesheet" href="{% get_static_prefix %}New/assets/libs/datatables.net-bs5/css/dataTables.bootstrap5.min.css">
<style>
  .upload-btn-wrapper {
  position: relative;
  overflow: hidden;
  display: inline-block;
  cursor: pointer;
  }
  .upload-btn-wrapper input[type=file] {
  font-size: 100px;
  position: absolute;
  left: 0;
  top: 0;
  cursor: pointer;
  width: 50%;
  opacity: 0;
  }
  </style>

<!-- APP CSS & APP SCSS -->
{% include "New/Extra/header.html" %}

<link rel="stylesheet" href="{% get_static_prefix %}New/assets/libs/datatables.net-bs5/css/dataTables.bootstrap5.min.css">


          <div class="datatables">
            <!-- start Zero Configuration -->
            <div class="card">
              <div class="card-body">
                <h4 class="card-title">'<span style="color:red" >{{Count}}</span>' Completed Accounts found for the key word '<span style="color:red" >{{Name}}</span>'</h4>
                <p class="card-subtitle mb-3">
                    <form class="row" action="{% url 'find_completed_logs' %}" method="post">
                    {% csrf_token %}
                    <div class="form-floating form-floating-outline mb-4 col-4">
                    <input type="text" name='Key' class="form-control" placeholder="" aria-label=""  required />
                    <label for="add-user-email">Account Name</label>
                    </div>

                  <div class="col-4">
                      <button type="submit"  class="btn btn-primary me-sm-3 me-1 data-submit">Search Account</button>
                  </div>
                </form>


                </p>
                <div class="table-responsive">
                  <table id="zep" class="table table-striped table-bordered text-nowrap align-middle">
                    <thead>
                      <!-- start row -->
                      <tr>


                        <th >
                          Client
                        </th>

                        <th >
                          Info Group
                         </th>

                         <th >
                          Time
                        </th>
                        <th >
                          Date
                        </th>
                         <th >
                          Action
                        </th>



                      </tr>
                      <!-- end row -->
                    </thead>
                    <tbody>



                      {% for i in Com %}

                      <tr id="{{i.id}}">




                        <td>
                          <img src="{% get_media_prefix %}Profiles/{{i.Client_id}}.jpg?" style="width: 60px;height: 60px;border-radius:100px;object-fit:cover" alt="image"/>

                          <a>
                            {{i.Client_Name}}
                          </a>

                        </td>


                        <td>
                         Completed Info Group {{i.Type}}
                        </td>

                        <td>
                          {{i.time}}
                        </td>
                         <td>
                          {{i.date}}
                        </td>
                        <td>
                            <a onclick="Open('{{i.id}}')"  type="button" class="btn bg-danger-subtle text-danger w-100 rounded-pill">Unconfirm</a>
                          </td>




                      </tr>

                      {% endfor %}
                      <!-- end row -->
                    </tbody>
                    <tfoot>
                      <!-- start row -->
                      <tr>


                        <th >
                          Client
                        </th>

                        <th >
                          Info Group
                         </th>

                         <th >
                          Time
                        </th>
                        <th >
                          Date
                        </th>
                        <th >
                          Action
                        </th>
                      <!-- end row -->
                    </tfoot>
                  </table>
                <div class="row">



              <nav aria-label="Page navigation example p-0" style="text-align: center;padding-bottom: 100px;">
                <span class="step-links">
                 {% if page_obj2 %}
  <div class="pagination my-3 d-flex gap-2 flex-wrap">

    {% if page_obj2.has_previous %}
      <a class="btn btn-outline-secondary" href="?page=1">&laquo; first</a>
      <a class="btn btn-outline-secondary" href="?page={{ page_obj2.previous_page_number }}">previous</a>
    {% endif %}

    <span class="btn btn-outline-primary disabled">
      Page {{ page_obj2.number }} of {{ page_obj2.paginator.num_pages }}
    </span>

    {% if page_obj2.has_next %}
      <a class="btn btn-outline-secondary" href="?page={{ page_obj2.next_page_number }}">next</a>
      <a class="btn btn-outline-secondary" href="?page={{ page_obj2.paginator.num_pages }}">last &raquo;</a>
    {% endif %}

  </div>
{% endif %}

                </span>
              </nav>


            </div>
                </div>

              </div>

        </div>
      <div class="row">



              <nav aria-label="Page navigation example p-0" style="text-align: center;padding-bottom: 100px;">
                <span class="step-links">
                     {% if page_obj %}
                  {% if page_obj.has_previous %}
                    <a class="btn btn-outline-secondary" href="?page=1">&laquo; first</a>
                    <a class="btn btn-outline-secondary" href="?page={{ page_obj.previous_page_number }}">previous</a>
                  {% endif %}
                  {% endif %}



                  <span class="current">
                    Page {{ page_obj.number }} of {{ page_obj.paginator.num_pages }}.
                  </span>

                  {% for num in page_obj.paginator.page_range %}
                    {% if num > page_obj.number|add:'-3' and num < page_obj.number|add:'3' %}
                      {% if page_obj.number == num %}
                        <span class="btn btn-secondary">{{ num }}</span>
                      {% else %}
                        <a class="btn btn-outline-secondary" href="?page={{ num }}">{{ num }}</a>
                      {% endif %}
                    {% endif %}
                  {% endfor %}


                  {% if page_obj %}
  {% if page_obj.has_next %}
    <a class="btn btn-outline-secondary" href="?page={{ page_obj.next_page_number }}">next</a>
    <a class="btn btn-outline-secondary" href="?page={{ page_obj.paginator.num_pages }}">last &raquo;</a>
  {% endif %}
{% endif %}

                </span>
              </nav>


            </div>




        {% include "New/Extra/footer.html" %}



        <!--Internal Echart Plugin -->
        <script src="{% get_static_prefix %}Main/build/assets/plugins/echart/echart.js"></script>

        <!-- Internal index js -->
        <link rel="modulepreload" href="{% get_static_prefix %}Main/build/assets/index-a335dc45.js" /><script type="module" src="{% get_static_prefix %}Main/build/assets/index-a335dc45.js"></script>
        <!-- Select2 js -->
        <script src="{% get_static_prefix %}Main/build/assets/plugins/select2/js/select2.full.min.js"></script>

        <!-- Data tables -->
        <script src="{% get_static_prefix %}Main/build/assets/plugins/datatable/js/jquery.dataTables.min.js"></script>
        <script src="{% get_static_prefix %}Main/build/assets/plugins/datatable/js/dataTables.bootstrap5.js"></script>
        <script src="{% get_static_prefix %}Main/build/assets/plugins/datatable/dataTables.responsive.min.js"></script>
        <script src="{% get_static_prefix %}Main/build/assets/plugins/datatable/responsive.bootstrap5.min.js"></script>


            <!-- Switcher js -->
            <link rel="modulepreload" href="{% get_static_prefix %}Main/build/assets/switcher-d57e6ced.js" /><script type="module" src="{% get_static_prefix %}Main/build/assets/switcher-d57e6ced.js"></script>
            <!-- APP JS-->
        <link rel="modulepreload" href="{% get_static_prefix %}Main/build/assets/app-2392f432.js" />
        <link rel="modulepreload" href="{% get_static_prefix %}Main/build/assets/apexcharts.common-7928d148.js" />
        <script type="module" src="{% get_static_prefix %}Main/build/assets/app-2392f432.js"></script>        <!-- END SCRIPTS -->

            <!-- sticky js-->
        <script src="{% get_static_prefix %}Main/build/assets/sticky.js"></script>


<script>

    function view_info(id){
      alert(document.getElementById('info'+id).value)
    }

  // vars
 function played(id){
  var img = document.getElementById('plyr-audio-player');
  img.src = '{% get_media_prefix %}Call_Logs/'+id+'.mp3'
 }

  upload1 = document.getElementById("file-input1"),

  upload1.addEventListener('change', (e) => {
    if (e.target.files.length) {

      const reader = new FileReader();
      reader.onload = (e)=> {
        if(e.target.result){
          var img = document.getElementById('plyr-audio-player');
          img.src = e.target.result;


        }
      };
      reader.readAsDataURL(e.target.files[0]);
    }
  });

  </script>



   <div id="cover"  style="background-color: rgba(15, 15, 15, 0.514);width: 100%;height: 100%;position: fixed;top:0px;text-align: center;visibility: hidden">
          <div class="col-xl-4 col-lg-4 col-xxl-4 col-md-12" style="position: fixed;top:30%;left: 40%;">
            <div class="card" id="cmain" style="visibility: hidden">
              <div class="card-body text-center ai-icon  text-primary" >
                <button style="position: absolute;right: 20px;" class="btn btn-sm btn-danger" onclick="Close()">x</button>
                <svg id="icon-customers" xmlns="http://www.w3.org/2000/svg" width="80" height="80" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-user">
                  <path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2" style="stroke-dasharray: 25, 45; stroke-dashoffset: 0;"></path>
                  <path d="M8,7A4,4 0,1,1 16,7A4,4 0,1,1 8,7" style="stroke-dasharray: 26, 46; stroke-dashoffset: 0;"></path>
                </svg>
                <h4 class="my-2">Type "DELETE" to delete this.</h4>
                <div class="form-group" >

                  <input type="text" id="pass2" class="form-control" style="text-align: center;" >
                </div>
                <button onclick="Delete()" id="si_button" class="btn my-2 btn-primary btn-lg px-4"><i class="fa fa-trash"></i> Delete</button>
              </div>
            </div>
          </div>
        </div>
        <input id="state" type="hidden">
  <script>


        function Open(id){
        document.getElementById("state").value = id
        document.getElementById('cover').setAttribute("style", "background-color:rgba(15, 15, 15, 0.514);width: 100%;height: 100%;position: fixed;top:0px;text-align: center;visibility: visible")
        document.getElementById('cmain').setAttribute("style", "visibility: visible")

        }
        function Close(){
        document.getElementById('cover').setAttribute("style", "visibility: hidden;z-index: 0;")
        document.getElementById('cmain').setAttribute("style", "z-index: 0;visibility: hidden;")

        }


function Delete(){
  var state = document.getElementById("state")
data = JSON.stringify({
id:state.value,
})
fetch("", {
method: 'DELETE',
body: data,
headers: { 'X-CSRFToken': '{{csrf_token}}','Accept': 'application/json, text/plain, */*',
    'Content-Type': 'application/json',
    },
})
.then(response => response.json())
.then(data => {
if (data === 'Ok'){
    document.getElementById(state.value).remove()
    state.value=""
    document.getElementById("pass2").value=""
    alert("Log has been deleted successfully!")
Close()
}else{
    alert("Please an error occured when deleting Log!")

}
});}

setInterval(load_all,1000);
function load_all(){


    var pass2 = document.getElementById("pass2").value
if (pass2==="DELETE"){

 document.getElementById("si_button").disabled = false;
}else{
 document.getElementById("si_button").disabled = true;
}
}




  </script>
      <script src="{% get_static_prefix %}New/assets/libs/datatables.net/js/jquery.dataTables.min.js"></script>
      <script src="{% get_static_prefix %}New/assets/js/datatable/datatable-basic.init.js"></script>


      <script type="text/javascript">
    $(document).ready(function() {
        // Initialize DataTable with id 'zep'
        $('#zep').DataTable();
    });
</script>
