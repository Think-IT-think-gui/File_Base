{% load static %}

<style>
  .upload-btn-wrapper {
  position: relative;
  overflow: hidden;
  display: inline-block;
  cursor: pointer;
  }
  .upload-btn-wrapper input[type=file] {
  font-size: 100px;
  position: absolute;
  left: 0;
  top: 0;
  cursor: pointer;
  width: 50%;
  opacity: 0;
  }
  </style>
{% include "New/Extra/header3.html" %}
      <!-- Content wrapper -->
      <div class="content-wrapper">

        <div class="container-xxl flex-grow-1 container-p-y">



          <h4 class="py-3 mb-4"><span class="text-muted fw-light">Dashboard/</span> My Bookings</h4>



  <div class="row">



            <div class="row mb-4 g-4">
              <div class="col-sm-6 col-xl-3">
                <div class="card">
                  <div class="card-body">
                    <div class="d-flex align-items-center justify-content-between">
                      <div class="content-left">
                        <h5 class="mb-1">{{Day}}</h5>
                        <small>Today's Booking</small>
                      </div>
                      <span class="badge bg-label-primary rounded-circle p-2">
                        <i class="ti-check"></i>
                      </span>
                    </div>
                  </div>
                </div>
              </div>
              <div class="col-sm-6 col-xl-3">
                <div class="card">
                  <div class="card-body">
                    <div class="d-flex align-items-center justify-content-between">
                      <div class="content-left">
                        <h5 class="mb-1">{{Week}}</h5>
                        <small>Weekly Booking</small>
                      </div>
                      <span class="badge bg-label-success rounded-circle p-2">
                        <i class="ti-reload"></i>
                      </span>
                    </div>
                  </div>
                </div>
              </div>
              <div class="col-sm-6 col-xl-3">
                <div class="card">
                  <div class="card-body">
                    <div class="d-flex align-items-center justify-content-between">
                      <div class="content-left">
                        <h5 class="mb-1">{{Month}}</h5>
                        <small>Monthly Booking</small>
                      </div>
                      <span class="badge bg-label-danger rounded-circle p-2">
                        <i class="ti-close"></i>
                      </span>
                    </div>
                  </div>
                </div>
              </div>
                 <div class="col-sm-6 col-xl-3">
                <div class="card">
                  <div class="card-body">
                    <div class="d-flex align-items-center justify-content-between">
                      <div class="content-left">
                        <h5 class="mb-1">{{Total}}</h5>
                        <small>Total Booking</small>
                      </div>
                      <span class="badge bg-label-danger rounded-circle p-2">
                        <i class="ti-close"></i>
                      </span>
                    </div>
                  </div>
                </div>
              </div>
              </div>

            <div class="card mb-4">
              <div class="card-header d-flex flex-wrap justify-content-between gap-3">
                <div class="card-title mb-0 me-1">
                  <h5 class="mb-1">My Bookings</h5>
                  <p class="mb-0">Total <strong style="color: red;">{{Total2}}</strong> schedules  you have created</p>
                </div>

              </div>


              <div class="card-body">
                <div class="row gy-4 mb-4">


                  {% for i in Booking %}
                  <div id='{{i.id}}' class="col-sm-6 col-lg-4">
                    <div class="card p-2 h-100 shadow-none border">
                      <span style="position:absolute;width:50px:hieght:50px;right:10px;font-size:15px" class="badge rounded-pill bg-danger">
                        {{i.Count}}
                      </span>

                      {% if i.Status == "Not In" %}
                      <span style="position:absolute;width:50px:hieght:50px" class="badge rounded-pill bg-danger">
                        <i  class="tf-icons mdi mdi-list-status"></i> {{i.Status}}
                      </span>
                     {% elif i.Status == "Clocked In" %}
                     <span style="position:absolute;width:50px:hieght:50px" class="badge rounded-pill bg-success">
                      <i  class="tf-icons mdi mdi-list-status"></i> {{i.Status}}
                    </span>
                     {% else %}
                     <span style="position:absolute;width:50px:hieght:50px" class="badge rounded-pill bg-warning">
                      <i  class="tf-icons mdi mdi-list-status"></i> {{i.Status}}
                    </span>
                     {% endif %}
                      <div class="rounded-2 text-center mb-3">

                         {% if i.Type == 'New' %}
                        <a href="{% url "view_booking" i.id %}"><img class="img-fluid" src="{% get_media_prefix %}Booking/{{i.id}}.jpg" style="object-fit: cover; width: 400px;height: 400px;border-radius:10px"   alt="tutor image 1"></a>
                      {% else %}
                         <a href="{% url "view_booking" i.id %}"><img class="img-fluid" src="{% get_media_prefix %}Profiles/{{i.Type}}.jpg" style="object-fit: cover; width: 400px;height: 400px;border-radius:10px"   alt="tutor image 1"></a>
                         {% endif %}
                      </div>
                      <div class="card-body p-3 pt-2">
                        <div class="d-flex justify-content-between align-items-center mb-3">
                          <span class="badge rounded-pill bg-label-primary"><img src="{% get_media_prefix %}Admin/{{i.User}}.jpg?{{Rand}}" style="object-fit: cover; width: 50px;height: 50px;border-radius: 100px;" alt="Post Author">
                          </span>
                          <p class="d-flex align-items-center justify-content-center gap-1 mb-0">
                            {{i.Admin}} <span class="text-warning"><i class="mdi mdi-star me-1"></i></span><span class="fw-normal">{{i.date}}</span>
                          </p>
                        </div>


                        <a href="{% url "view_booking" i.id %}" class="h5">{{i.Name}}</a>

                        <p><i class="mdi mdi-phone-classic"></i> Contact: {{i.Contact}}</p>
                                    <p><i class="mdi mdi-map-marker-radius"></i> Location: {{i.Location}}</p>




                        <div class="d-flex flex-column flex-md-row gap-3 text-nowrap flex-wrap flex-md-nowrap  flex-lg-wrap flex-xxl-nowrap">

                          <a onclick="setup('{{i.id}}')" data-bs-toggle="modal" data-bs-target="#deleteModal" class="w-100 btn btn-outline-primary d-flex align-items-center" >
                            <span class="me-1">Delete</span><i class="mdi mdi-trash-can-outline lh-1 scaleX-n1-rtl"></i>
                          </a>

                        </div>
                        <div style="padding-top:20px">

                      </div>
                      </div>
                    </div>
                  </div>
                 {% endfor %}






                </div>

              </div>
            </div>
 <nav aria-label="Page navigation example p-0" style="text-align: center;padding-bottom: 100px;">
     <span class="step-links">
                {% if page_obj.has_previous %}
                  <a class="btn btn-outline-secondary" href="?page=1">&laquo; first</a>
                  <a class="btn btn-outline-secondary" href="?page={{ page_obj.previous_page_number }}">previous</a>
                {% endif %}

                <span class="current">
                  Page {{ page_obj.number }} of {{ page_obj.paginator.num_pages }}.
                </span>

                {% for num in page_obj.paginator.page_range %}
                  {% if num > page_obj.number|add:'-3' and num < page_obj.number|add:'3' %}
                    {% if page_obj.number == num %}
                      <span class="btn btn-secondary">{{ num }}</span>
                    {% else %}
                      <a class="btn btn-outline-secondary" href="?page={{ num }}">{{ num }}</a>
                    {% endif %}
                  {% endif %}
                {% endfor %}

                {% if page_obj.has_next %}
                  <a class="btn btn-outline-secondary" href="?page={{ page_obj.next_page_number }}">next</a>
                  <a class="btn btn-outline-secondary" href="?page={{ page_obj.paginator.num_pages }}">last &raquo;</a>
                {% endif %}
              </span>

            </nav>

          </div>

          <div class="offcanvas offcanvas-end" tabindex="-1" id="offcanvasAddUser" aria-labelledby="offcanvasAddUserLabel">
            <div class="offcanvas-header">
              <h5 id="offcanvasAddUserLabel" class="offcanvas-title">Schedule Booking</h5>
              <button type="button" class="btn-close text-reset" data-bs-dismiss="offcanvas" aria-label="Close"></button>
            </div>
            <div class="offcanvas-body mx-0 flex-grow-0 h-100">
              <form action="{% url "manage_booking" %}" method="post" enctype="multipart/form-data">
                {% csrf_token %}
                  <input  required  name="Type" value="New" type="hidden" />
                <div style="text-align: center;"  class="result">
                  <img id='img' style="border-radius: 5px;width:200px;height:200px;object-fit: cover; " src="{% get_static_prefix %}New\assets\images\profile\user-3.jpg">

                  </div>
                <div style="text-align: center;" class="box">
                  <div style="padding-top: 20px;padding-bottom: 20px;"></div>
                  <div class="upload-btn-wrapper">
                  <button  class="btn btn-light btn-block">Select image</button>

                  <input  class="mdc-text-field__input"  id="file-input" style="width: 100%;" required type="file" name="New_Img" accept="image/*" />
                  </div>
                </div>
                <div style="padding-top: 10px;"></div>
                <div class="form-floating form-floating-outline mb-4">
                  <input type="text" class="form-control" id="add-user-fullname" placeholder="John Doe" required name="Name" aria-label="John Doe" />
                  <label for="add-user-fullname">Client's Name</label>
                </div>
                <div class="form-floating form-floating-outline mb-4">
                  <select type="text" id="add-user-email" class="form-control" placeholder="" aria-label="" name="Gender" required>
                  <option>Male</option>
                  <option>Female</option>

                  </select>
                  <label for="add-user-email">Client's Gender</label>
                </div>
                <div class="form-floating form-floating-outline mb-4">
                  <input type="text" id="add-user-email" class="form-control" placeholder="" aria-label="" name="Location" required />
                  <label for="add-user-email">Client's Address</label>
                </div>
                <div class="form-floating form-floating-outline mb-4">
                  <input type="text" id="add-user-email" class="form-control" placeholder="" aria-label="" name="Contact" required />
                  <label for="add-user-email">Client's Contact</label>
                </div>
                <div class="form-floating form-floating-outline mb-4">
                  <input type="text" id="add-user-email" class="form-control" placeholder="" aria-label="" name="Topic" required />
                  <label for="add-user-email">Meeting Subject</label>
                </div>
                <div class="form-floating form-floating-outline mb-4">
                  <input type="time" id="add-user-email" class="form-control" placeholder="" aria-label="" name="Time" required />
                  <label for="add-user-email">Schedule Time</label>
                </div>
                <div class="form-floating form-floating-outline mb-4">
                  <input type="date" id="add-user-email" class="form-control" placeholder="" aria-label="" name="Date" required />
                  <label for="add-user-email">Schedule Date</label>
                </div>



                <div class="form-floating form-floating-outline mb-4">
                  <textarea type="text" id="add-user-email"  class="form-control"  rows="4" cols="50" placeholder="describ the reason for the meeting.." name="About" required ></textarea>
                  <label for="add-user-email">Meeting Description</label>
                </div>

                <button type="submit" class="btn btn-primary me-sm-3 me-1 data-submit">Submit</button>
                <button type="reset" class="btn btn-outline-secondary" data-bs-dismiss="offcanvas">Cancel</button>
              </form>
            </div>
          </div>

          <script>
      function set_book(id,link){
          document.getElementById("c_id").value=id
          document.getElementById("imgg").src='{% get_media_prefix %}'+link+'.jpg'


        }
            upload = document.getElementById("file-input"),
            upload.addEventListener('change', (e) => {
              if (e.target.files.length) {
              const reader = new FileReader();
              reader.onload = (e)=> {
                if(e.target.result){
                let img = document.getElementById('img');
                img.src = e.target.result;
                }
              };
              reader.readAsDataURL(e.target.files[0]);
              }
            });


            </script>
      </div>
          <!-- / Content -->

          <div class="modal fade contentmodal" id="deleteModal" tabindex="-1" aria-hidden="true">
            <div class="modal-dialog modal-dialog-centered">
                <div class="modal-content doctor-profile">
                    <div class="modal-header pb-0 border-bottom-0  justify-content-end">
                        <button type="button" class="close-btn" data-bs-dismiss="modal" aria-label="Close"><i class="feather-x-circle"></i></button>
                    </div>
                    <div class="modal-body">
                        <div class="delete-wrap text-center">
                            <div class="del-icon"><i class="feather-x-circle"></i></div>
                            <h4>Type "DELETE" in below to delete this.</h4>
                            <div class="submit-section">
                                <input id="pass2" class="form-control" type="text" id="test" style="text-align: center;">

                            </div>
                            <div style="padding-top: 20px;" class="submit-section">
                                <button onclick="Delete()"  class="btn btn-danger me-2" id="si_button">Delete This</button>

                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
          <input type="hidden" value="" id='hold_id'>
          <script>

          function setup(id){
            document.getElementById('hold_id').value=id
          }

    function Delete(){
          var state = document.getElementById("hold_id")
        data = JSON.stringify({
        id:state.value,
        })
        fetch("{% url 'agent_delete_booking' %}", {
        method: 'POST',
        body: data,
        headers: { 'X-CSRFToken': '{{csrf_token}}','Accept': 'application/json, text/plain, */*',
            'Content-Type': 'application/json',
            },
        })
        .then(response => response.json())
        .then(data => {
        if (data === 'Ok'){
            document.getElementById(state.value).remove()
            state.value=""
            document.getElementById("pass2").value=""
            alert("Product has been deleted successfully!")
        Close()
        }else{
            alert("Please an error occured when deleting Product!")

        }
        });}

        setInterval(load_all,1000);
        function load_all(){


            var pass2 = document.getElementById("pass2").value
        if (pass2==="DELETE"){

         document.getElementById("si_button").disabled = false;
        }else{
         document.getElementById("si_button").disabled = true;
        }
        }





          </script>






         <div class="offcanvas offcanvas-end" tabindex="-1" id="offcanvasAddUser22" aria-labelledby="offcanvasAddUserLabel">
              <div class="offcanvas-header">
                <h5 id="offcanvasAddUserLabel" class="offcanvas-title">Assigning ID Card</h5>
                <button type="button" class="btn-close text-reset" data-bs-dismiss="offcanvas" aria-label="Close"></button>
              </div>
              <div class="offcanvas-body mx-0 flex-grow-0 h-100">
                <div>
                  {% csrf_token %}

                  <div style="text-align: center;"  class="result">
                    <img id='imgg' style="border-radius: 5px;width:200px;height:200px;object-fit: cover; " src="{% get_static_prefix %}Manager\assets\img\img-02.jpg">

                    </div>

                  <div style="padding-top: 10px;"></div>

                  <input type="hidden" class="form-control" placeholder="" aria-label="" name="Type" value="Client" />
                  <input type="hidden" class="form-control" placeholder="" aria-label="" name="Client" value="" id="c_id"/>
                  <div class="form-floating form-floating-outline mb-4">
                    <select onchange='check_id()' class="form-control" placeholder=""  aria-label="" id="Card" required >
                    {% for i in ID %}
                    <option value="{{i.id}}">Card {{i.id}}</option>
                    {% endfor %}
                    </select>
                    <label for="add-user-email">Select Card</label>
                  </div>



                  <p style="padding-bottom:10px">Assign Card Function</p>

                  {% for i in Point %}
                  <div class="form-check form-check-inline col-12">
                        <input class="form-check-input success check-outline outline-success" type="checkbox" id="Point_{{i.id}}" value="{{i.id}}" >
                        <label class="form-check-label" for="success2-outline-check">{{i.Name}}</label>
                  </div>
                  {% endfor %}



                 <p style="padding-bottom:10px"></p>
                  <div class="form-floating form-floating-outline mb-4">
                    <textarea type="text" id="About"  class="form-control"  rows="10" cols="50"   required ></textarea>
                    <label for="add-user-email">Meeting Description</label>
                  </div>

                  <button type="button" onclick="assign()" class="btn btn-primary me-sm-3 me-1 data-submit">Submit</button>
                  <button type="reset" class="btn btn-outline-secondary" data-bs-dismiss="offcanvas">Cancel</button>
                </div>
              </div>
            </div>
          </div>







<script>





{% include "New/Extra/footer.html" %}